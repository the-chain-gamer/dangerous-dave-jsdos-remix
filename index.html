<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dangerous Dave (DOS)</title>

  <!-- js-dos v8 -->
  <link rel="stylesheet" href="https://v8.js-dos.com/latest/js-dos.css">

  <!-- Farcade SDK (must be inside the game page, not just the Remix wrapper) -->
  <script src="https://cdn.jsdelivr.net/npm/@farcade/game-sdk@latest/dist/index.min.js"></script>

  <style>
    html, body, #dos { height: 100%; margin: 0; background: #000; }

    /* Controls low on screen so they don't cover gameplay */
    .hud-left, .hud-right { position: fixed; z-index: 50; pointer-events: auto; }
    .hud-left  { left: 12px;  bottom: calc(12px + env(safe-area-inset-bottom)); }
    .hud-right { right: 12px; bottom: calc(12px + env(safe-area-inset-bottom));
                 display: flex; flex-direction: column; gap: 10px; }

    /* Keyboard-like arrows: < v > on one row, ^ centered above v */
    .dpad-kb {
      display: grid; gap: 8px;
      grid-template-columns: 56px 56px 56px;
      grid-template-rows:    56px 56px;
    }
    .btn {
      min-width: 56px; min-height: 56px; border-radius: 12px;
      border: 1px solid #2f3a4a; background: #1f2937; color: #fff;
      font: 700 14px/1 system-ui, sans-serif; opacity: .92; cursor: pointer;
      touch-action: none; user-select: none;
    }
    .btn:active { opacity: 1; }
    .up    { grid-column: 2; grid-row: 1; }
    .left  { grid-column: 1; grid-row: 2; }
    .down  { grid-column: 2; grid-row: 2; }
    .right { grid-column: 3; grid-row: 2; }
    .act   { min-width: 72px; }
  </style>
</head>
<body>
  <div id="dos"></div>

  <!-- On-screen controls -->
  <div class="hud-left">
    <div class="dpad-kb">
      <button class="btn up"    id="k-up">▲</button>
      <button class="btn left"  id="k-left">◀</button>
      <button class="btn down"  id="k-down">▼</button>
      <button class="btn right" id="k-right">▶</button>
    </div>
  </div>
  <div class="hud-right">
    <button class="btn act" id="k-ctrl">CTRL</button>
    <button class="btn act" id="k-alt">ALT</button>
  </div>

  <script src="https://v8.js-dos.com/latest/js-dos.js"></script>
  <script>
    (function () {
      // --- Utils -------------------------------------------------------------
      const SDK = () => window.FarcadeSDK?.singlePlayer?.actions;
      const hasSDK = () => !!SDK();
      const safe = (fn) => { try { fn && fn(); } catch (e) {} };
      const log  = (...a) => console.log("[dave]", ...a);

      // Attempt to mute/unmute by suspending/resuming the Aud
